<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–≠–∫—Å–∫—É—Ä—Å–∏–∏ - –ó–∞–≤–æ–¥–ü–∏—â–µ–ü—Ä–æ–º</title>
    <link rel="stylesheet" href="src/css/style.css">
    <link rel="stylesheet" href="src/css/modal.css">
    <link rel="stylesheet" href="src/css/forms.css">
</head>
<body class="excursions-bg">
    <!-- –•–µ–¥–µ—Ä -->
    <header class="header">
        <nav class="nav">
            <div class="nav-links">
                <a href="index.html" class="nav-link">
                    <span class="nav-icon">üè†</span>
                    <span>–ì–ª–∞–≤–Ω–∞—è</span>
                </a>
                <a href="excursions.html" class="nav-link active">
                    <span class="nav-icon">üìÖ</span>
                    <span>–≠–∫—Å–∫—É—Ä—Å–∏–∏</span>
                </a>
                <a href="#" class="nav-link" id="gameLink">
                    <span class="nav-icon">üéÆ</span>
                    <span>–ò–≥—Ä–∞</span>
                </a>
            </div>
        </nav>
    </header>

    <!-- –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="excursions-container">
        <h1 class="page-title">–≠–∫—Å–∫—É—Ä—Å–∏–∏</h1>
        
        <div class="tours-grid">
            <!-- –ü–∏–≤–Ω–∞—è —ç–∫—Å–∫—É—Ä—Å–∏—è -->
            <div class="tour-column beer-tour">
                <div class="tour-header">
                    <div class="tour-icon">üç∫</div>
                    <h2>–ü–∏–≤–Ω–∞—è —ç–∫—Å–∫—É—Ä—Å–∏—è</h2>
                    <div class="tour-divider"></div>
                    <p><strong>–î–Ω–∏:</strong> –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, –°—Ä–µ–¥–∞, –ü—è—Ç–Ω–∏—Ü–∞</p>
                    <p><strong>–í—Ä–µ–º—è:</strong> 12:00, 14:00, 16:00</p>
                </div>
                
                <div class="days-grid">
                    <div class="day-card" data-day="monday">
                        <div class="day-name">–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</div>
                        <div class="day-circle">1</div>
                    </div>
                    <div class="day-card" data-day="wednesday">
                        <div class="day-name">–°—Ä–µ–¥–∞</div>
                        <div class="day-circle">3</div>
                    </div>
                    <div class="day-card" data-day="friday">
                        <div class="day-name">–ü—è—Ç–Ω–∏—Ü–∞</div>
                        <div class="day-circle">5</div>
                    </div>
                </div>
                
                <!-- –í–†–ï–ú–Ø –î–õ–Ø –ü–û–ù–ï–î–ï–õ–¨–ù–ò–ö–ê -->
                <div class="times-container" data-day="monday" style="display: block;">
                    <h4>–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫:</h4>
                    <div class="time-slot" data-time="12:00" data-tour="beer" data-day="monday">
                        12:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                    <div class="time-slot" data-time="14:00" data-tour="beer" data-day="monday">
                        14:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                    <div class="time-slot" data-time="16:00" data-tour="beer" data-day="monday">
                        16:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                </div>
                
                <!-- –í–†–ï–ú–Ø –î–õ–Ø –°–†–ï–î–´ -->
                <div class="times-container" data-day="wednesday" style="display: none;">
                    <h4>–°—Ä–µ–¥–∞:</h4>
                    <div class="time-slot" data-time="12:00" data-tour="beer" data-day="wednesday">
                        12:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                    <div class="time-slot" data-time="14:00" data-tour="beer" data-day="wednesday">
                        14:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                    <div class="time-slot" data-time="16:00" data-tour="beer" data-day="wednesday">
                        16:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                </div>
                
                <!-- –í–†–ï–ú–Ø –î–õ–Ø –ü–Ø–¢–ù–ò–¶–´ -->
                <div class="times-container" data-day="friday" style="display: none;">
                    <h4>–ü—è—Ç–Ω–∏—Ü–∞:</h4>
                    <div class="time-slot" data-time="12:00" data-tour="beer" data-day="friday">
                        12:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                    <div class="time-slot" data-time="14:00" data-tour="beer" data-day="friday">
                        14:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                    <div class="time-slot" data-time="16:00" data-tour="beer" data-day="friday">
                        16:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                </div>
            </div>
            
            <!-- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å -->
            <div class="column-divider"></div>
            
            <!-- –ö–≤–∞—Å–Ω–∞—è —ç–∫—Å–∫—É—Ä—Å–∏—è -->
            <div class="tour-column kvas-tour">
                <div class="tour-header">
                    <div class="tour-icon">ü•§</div>
                    <h2>–ö–≤–∞—Å–Ω–∞—è —ç–∫—Å–∫—É—Ä—Å–∏—è</h2>
                    <div class="tour-divider"></div>
                    <p><strong>–î–Ω–∏:</strong> –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, –°—Ä–µ–¥–∞, –ü—è—Ç–Ω–∏—Ü–∞</p>
                    <p><strong>–í—Ä–µ–º—è:</strong> 13:00, 15:00, 17:00</p>
                </div>
                
                <div class="days-grid">
                    <div class="day-card" data-day="monday">
                        <div class="day-name">–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</div>
                        <div class="day-circle">1</div>
                    </div>
                    <div class="day-card" data-day="wednesday">
                        <div class="day-name">–°—Ä–µ–¥–∞</div>
                        <div class="day-circle">3</div>
                    </div>
                    <div class="day-card" data-day="friday">
                        <div class="day-name">–ü—è—Ç–Ω–∏—Ü–∞</div>
                        <div class="day-circle">5</div>
                    </div>
                </div>
                
                <!-- –í–†–ï–ú–Ø –î–õ–Ø –ü–û–ù–ï–î–ï–õ–¨–ù–ò–ö–ê -->
                <div class="times-container" data-day="monday" style="display: block;">
                    <h4>–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫:</h4>
                    <div class="time-slot" data-time="13:00" data-tour="kvas" data-day="monday">
                        13:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                    <div class="time-slot" data-time="15:00" data-tour="kvas" data-day="monday">
                        15:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                    <div class="time-slot" data-time="17:00" data-tour="kvas" data-day="monday">
                        17:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                </div>
                
                <!-- –í–†–ï–ú–Ø –î–õ–Ø –°–†–ï–î–´ -->
                <div class="times-container" data-day="wednesday" style="display: none;">
                    <h4>–°—Ä–µ–¥–∞:</h4>
                    <div class="time-slot" data-time="13:00" data-tour="kvas" data-day="wednesday">
                        13:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                    <div class="time-slot" data-time="15:00" data-tour="kvas" data-day="wednesday">
                        15:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                    <div class="time-slot" data-time="17:00" data-tour="kvas" data-day="wednesday">
                        17:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                </div>
                
                <!-- –í–†–ï–ú–Ø –î–õ–Ø –ü–Ø–¢–ù–ò–¶–´ -->
                <div class="times-container" data-day="friday" style="display: none;">
                    <h4>–ü—è—Ç–Ω–∏—Ü–∞:</h4>
                    <div class="time-slot" data-time="13:00" data-tour="kvas" data-day="friday">
                        13:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                    <div class="time-slot" data-time="15:00" data-tour="kvas" data-day="friday">
                        15:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                    <div class="time-slot" data-time="17:00" data-tour="kvas" data-day="friday">
                        17:00 <small>(<span class="seats-count">15</span> –º–µ—Å—Ç)</small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="booking-center">
            <button id="openBookingBtn" class="btn-book-main" onclick="openBookingForm()" disabled>
                <span class="btn-icon">üìã</span>
                <span>–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —ç–∫—Å–∫—É—Ä—Å–∏—é</span>
            </button>
            <p class="booking-hint">–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–Ω—å –∏ –≤—Ä–µ–º—è –¥–ª—è –∑–∞–ø–∏—Å–∏</p>
        </div>
    </main>

    <!-- –§–æ—Ä–º–∞ –∑–∞–ø–∏—Å–∏ –Ω–∞ —ç–∫—Å–∫—É—Ä—Å–∏—é -->
    <div id="bookingModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-modal" onclick="closeBookingModal()">&times;</span>
            <h2>–ó–∞–ø–∏—Å—å –Ω–∞ —ç–∫—Å–∫—É—Ä—Å–∏—é</h2>
            <form id="bookingForm">
                <div class="form-group">
                    <label for="bookingName">–§–ò–û *</label>
                    <input type="text" id="bookingName" name="name" required>
                </div>
                <div class="form-group">
                    <label for="bookingPhone">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ *</label>
                    <input type="tel" id="bookingPhone" name="phone" required placeholder="8 800 352-67-66">
                </div>
                <div class="form-group">
                    <label for="bookingEmail">Email</label>
                    <input type="email" id="bookingEmail" name="email" placeholder="example@mail.ru">
                </div>
                <div class="form-group">
                    <label for="bookingPeople">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–µ–ª–æ–≤–µ–∫ *</label>
                    <select id="bookingPeople" name="people" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ</option>
                        <option value="1">1 —á–µ–ª–æ–≤–µ–∫</option>
                        <option value="2">2 —á–µ–ª–æ–≤–µ–∫–∞</option>
                        <option value="3">3 —á–µ–ª–æ–≤–µ–∫–∞</option>
                        <option value="4">4 —á–µ–ª–æ–≤–µ–∫–∞</option>
                        <option value="5">5 —á–µ–ª–æ–≤–µ–∫</option>
                        <option value="6">6 —á–µ–ª–æ–≤–µ–∫</option>
                        <option value="7">7 —á–µ–ª–æ–≤–µ–∫</option>
                        <option value="8">8 —á–µ–ª–æ–≤–µ–∫</option>
                        <option value="9">9 —á–µ–ª–æ–≤–µ–∫</option>
                        <option value="10">10 —á–µ–ª–æ–≤–µ–∫</option>
                        <option value="11">11 —á–µ–ª–æ–≤–µ–∫</option>
                        <option value="12">12 —á–µ–ª–æ–≤–µ–∫</option>
                        <option value="13">13 —á–µ–ª–æ–≤–µ–∫</option>
                        <option value="14">14 —á–µ–ª–æ–≤–µ–∫</option>
                        <option value="15">15 —á–µ–ª–æ–≤–µ–∫</option>
                    </select>
                </div>
                <div class="booking-details" id="bookingDetails">
                    <p>–≠–∫—Å–∫—É—Ä—Å–∏—è: <span id="selectedTourName"></span></p>
                    <p>–î–µ–Ω—å: <span id="selectedDayName"></span></p>
                    <p>–í—Ä–µ–º—è: <span id="selectedTime"></span></p>
                </div>
                <button type="submit" class="btn btn-book-confirm">
                    <span class="btn-icon">‚úÖ</span>
                    <span>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–ø–∏—Å—å</span>
                </button>
            </form>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å -->
    <footer class="bottom-panel">
        <div class="panel-left">
            <span class="contact-icon">üìû</span>
            <span>8 800 352-67-66</span>
        </div>
        <div class="panel-center">
            <button class="btn-review" onclick="location.href='index.html'">
                <span class="review-icon">‚úçÔ∏è</span>
                <span>–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</span>
            </button>
        </div>
        <div class="panel-right">
            <span class="contact-icon">‚úâÔ∏è</span>
            <span>pivo@yandex.ru</span>
        </div>
    </footer>

    <script src="src/js/db-service.js"></script>
    <script>
// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
let selectedTour = null;
let selectedDay = null;
let selectedTime = null;
let selectedDayName = '';

// –§—É–Ω–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ –¥–Ω—è
function selectDay(dayElement) {
    const day = dayElement.dataset.day;
    const dayName = dayElement.querySelector('.day-name').textContent;
    
    console.log('–í—ã–±—Ä–∞–Ω –¥–µ–Ω—å:', day, dayName);
    
    // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö –¥–Ω–µ–π
    document.querySelectorAll('.day-card').forEach(card => {
        card.classList.remove('selected');
    });
    
    // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –¥–µ–Ω—å
    dayElement.classList.add('selected');
    selectedDay = day;
    selectedDayName = dayName;
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞–∫–æ–π —Ç—É—Ä (–ø–∏–≤–æ –∏–ª–∏ –∫–≤–∞—Å)
    const tourColumn = dayElement.closest('.tour-column');
    selectedTour = tourColumn.classList.contains('beer-tour') ? 'beer' : 'kvas';
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–Ω—è
    showDayTimes(day);
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
    selectedTime = null;
    
    updateBookingButton();
}

// –ü–æ–∫–∞–∑–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–Ω—è
function showDayTimes(day) {
    // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤—Ä–µ–º–µ–Ω–∏
    document.querySelectorAll('.times-container').forEach(container => {
        container.style.display = 'none';
    });
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–Ω—è
    const containers = document.querySelectorAll(`.times-container[data-day="${day}"]`);
    containers.forEach(container => {
        container.style.display = 'block';
    });
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
    document.querySelectorAll('.time-slot').forEach(slot => {
        slot.classList.remove('selected');
    });
}

// –§—É–Ω–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏
function selectTime(timeElement) {
    if (!selectedTour || !selectedDay) {
        alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–µ–Ω—å!');
        return;
    }
    
    const time = timeElement.dataset.time;
    console.log('–í—ã–±—Ä–∞–Ω–æ –≤—Ä–µ–º—è:', time, '–¥–ª—è –¥–Ω—è:', selectedDay, '—Ç—É—Ä–∞:', selectedTour);
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
    const availableSeats = window.db.getAvailableSeats(selectedTour, selectedDay, time);
    console.log('–î–æ—Å—Ç—É–ø–Ω–æ –º–µ—Å—Ç:', availableSeats);
    
    if (availableSeats === 0) {
        alert('–≠—Ç–æ –≤—Ä–µ–º—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ! –í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–µ –≤—Ä–µ–º—è.');
        return;
    }
    
    // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö –≤—Ä–µ–º–µ–Ω–∏ –≤ –≠–¢–û–ú –î–ù–ï
    const currentDayContainers = document.querySelectorAll(`.times-container[data-day="${selectedDay}"]`);
    currentDayContainers.forEach(container => {
        container.querySelectorAll('.time-slot').forEach(slot => {
            slot.classList.remove('selected');
        });
    });
    
    // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
    timeElement.classList.add('selected');
    selectedTime = time;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∏ dropdown
    updateBookingButton();
    updatePeopleDropdown();
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –∑–∞–ø–∏—Å–∏
function updateBookingButton() {
    const button = document.getElementById('openBookingBtn');
    if (selectedTour && selectedDay && selectedTime) {
        button.disabled = false;
        console.log('‚úÖ –ö–Ω–æ–ø–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞:', {tour: selectedTour, day: selectedDay, time: selectedTime});
    } else {
        button.disabled = true;
        console.log('‚ùå –ö–Ω–æ–ø–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞:', {tour: selectedTour, day: selectedDay, time: selectedTime});
    }
}

function updatePeopleDropdown() {
    const select = document.getElementById('bookingPeople');
    if (!select) return;
    
    const availableSeats = window.db.getAvailableSeats(selectedTour, selectedDay, selectedTime);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ –æ–ø—Ü–∏–∏
    for (let i = 0; i < select.options.length; i++) {
        const option = select.options[i];
        const value = parseInt(option.value);
        
        if (option.value === '') continue; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç "–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ"
        
        if (value > availableSeats) {
            // –ï—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ
            option.disabled = true;
            option.textContent = option.textContent.replace(/ \(\d+ –º–µ—Å—Ç\)/, '') + ` (–Ω–µ—Ç –º–µ—Å—Ç)`;
            option.style.textDecoration = 'line-through';
            option.style.color = '#999';
            option.style.fontStyle = 'italic';
        } else {
            option.disabled = false;
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç
            option.textContent = option.textContent.replace(/ \(\d+ –º–µ—Å—Ç\)/, '').replace(/ \(–Ω–µ—Ç –º–µ—Å—Ç\)/, '');
            if (availableSeats <= 5 && value <= availableSeats) {
                option.textContent += ` (${availableSeats - value + 1} –º–µ—Å—Ç)`;
                option.style.color = value === availableSeats ? '#ff9900' : '';
            }
            option.style.textDecoration = '';
            option.style.color = '';
            option.style.fontStyle = '';
        }
    }
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä, –µ—Å–ª–∏ —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ
    const currentValue = parseInt(select.value);
    if (currentValue > availableSeats) {
        select.value = '';
    }
} 

function updateAllSeatsDisplay() {
    const data = window.db.getToursData();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ time-slot —ç–ª–µ–º–µ–Ω—Ç—ã
    document.querySelectorAll('.time-slot').forEach(slot => {
        const tour = slot.dataset.tour;
        const day = slot.dataset.day;
        const time = slot.dataset.time;
        
        const tourData = tour === 'beer' ? data.beerTours : data.kvasTours;
        
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö
        if (tourData && tourData[day] && tourData[day][time]) {
            const seats = tourData[day][time].seats;
            const seatsElement = slot.querySelector('.seats-count');
            
            if (seatsElement) {
                seatsElement.textContent = seats;
                
                // –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
                if (seats === 0) {
                    seatsElement.style.color = '#ff4444';
                } else if (seats <= 5) {
                    seatsElement.style.color = '#ff9900';
                } else {
                    seatsElement.style.color = '#44cc44';
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–ª–∞—Å—Å booked
            if (seats === 0) {
                slot.classList.add('booked');
                slot.style.cursor = 'not-allowed';
                slot.style.opacity = '0.6';
            } else {
                slot.classList.remove('booked');
                slot.style.cursor = 'pointer';
                slot.style.opacity = '1';
            }
        } else {
            console.error('–°–ª–æ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:', { tour, day, time });
        }
    });
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫, –∫–æ–≥–¥–∞ –≤—ã–±—Ä–∞–Ω –¥–µ–Ω—å –∏ –≤—Ä–µ–º—è
    if (selectedTour && selectedDay && selectedTime) {
        updatePeopleDropdown();
    }
}
// –û—Ç–∫—Ä—ã—Ç–∏–µ —Ñ–æ—Ä–º—ã –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
window.openBookingForm = function() {
    if (!selectedTour || !selectedDay || !selectedTime) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥–µ–Ω—å –∏ –≤—Ä–µ–º—è!');
        return;
    }
    
    // –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–µ—Ç–∞–ª–∏ –≤ —Ñ–æ—Ä–º–µ
    document.getElementById('selectedTourName').textContent = 
        selectedTour === 'beer' ? '–ü–∏–≤–Ω–∞—è —ç–∫—Å–∫—É—Ä—Å–∏—è' : '–ö–≤–∞—Å–Ω–∞—è —ç–∫—Å–∫—É—Ä—Å–∏—è';
    document.getElementById('selectedDayName').textContent = selectedDayName;
    document.getElementById('selectedTime').textContent = selectedTime;
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
    document.getElementById('bookingModal').style.display = 'flex';
    document.body.style.overflow = 'hidden';
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ —Ñ–æ—Ä–º—ã
window.closeBookingModal = function() {
    document.getElementById('bookingModal').style.display = 'none';
    document.body.style.overflow = 'auto';
}

function processBooking() {
    const name = document.getElementById('bookingName').value;
    const phone = document.getElementById('bookingPhone').value;
    const email = document.getElementById('bookingEmail').value;
    const peopleSelect = document.getElementById('bookingPeople');
    const people = parseInt(peopleSelect.value);
    
    console.log('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–µ–ª–æ–≤–µ–∫:', people, '—Ç–∏–ø:', typeof people);
    
    // –í–∞–ª–∏–¥–∞—Ü–∏—è
    if (!name || !phone || !people) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–µ–ª–æ–≤–µ–∫!');
        return;
    }
    
    if (people < 1 || people > 15) {
        alert('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–µ–ª–æ–≤–µ–∫ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 1 –¥–æ 15!');
        return;
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–µ—Å—Ç –ü–ï–†–ï–î –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
    const availableSeats = window.db.getAvailableSeats(selectedTour, selectedDay, selectedTime);
    if (people > availableSeats) {
        alert(`‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç!\n–î–æ—Å—Ç—É–ø–Ω–æ: ${availableSeats} –º–µ—Å—Ç\n–í—ã –≤—ã–±—Ä–∞–ª–∏: ${people} —á–µ–ª–æ–≤–µ–∫\n\n–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –º–µ–Ω—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–µ–ª–æ–≤–µ–∫.`);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º dropdown
        updatePeopleDropdown();
        return;
    }
    
    // –ë—Ä–æ–Ω–∏—Ä—É–µ–º
    const result = window.db.bookTour(selectedTour, selectedDay, selectedTime, {
        name: name,
        phone: phone,
        email: email,
        people: people
    });
    
    if (result.success) {
        alert(`‚úÖ –ó–∞–ø–∏—Å—å —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞!\n\n–≠–∫—Å–∫—É—Ä—Å–∏—è: ${selectedTour === 'beer' ? '–ü–∏–≤–Ω–∞—è' : '–ö–≤–∞—Å–Ω–∞—è'}\n–î–µ–Ω—å: ${selectedDayName}\n–í—Ä–µ–º—è: ${selectedTime}\n–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${people} —á–µ–ª–æ–≤–µ–∫\n–ò–º—è: ${name}\n–¢–µ–ª–µ—Ñ–æ–Ω: ${phone}\n–ù–æ–º–µ—Ä –±—Ä–æ–Ω–∏: ${result.bookingId}\n\n${result.message}`);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        updateAllSeatsDisplay();
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
        document.getElementById('bookingForm').reset();
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä
        selectedTour = selectedDay = selectedTime = selectedDayName = null;
        document.querySelectorAll('.day-card.selected, .time-slot.selected').forEach(el => {
            el.classList.remove('selected');
        });
        
        // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫
        showDayTimes('monday');
        
        // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ –¥–Ω–µ–π
        document.querySelectorAll('.day-card').forEach(card => {
            card.classList.remove('selected');
        });
        
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –∏ –±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
        closeBookingModal();
        updateBookingButton();
    } else {
        alert('‚ùå –û—à–∏–±–∫–∞: ' + result.message);
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', function() {
    console.log('üìÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ —ç–∫—Å–∫—É—Ä—Å–∏–π –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
    window.db = new DatabaseService();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Å—Ç –¥–ª—è –≤—Å–µ—Ö –¥–Ω–µ–π
    updateAllSeatsDisplay();
    
    // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –¥–Ω–µ–π
    document.querySelectorAll('.day-card').forEach(card => {
        card.addEventListener('click', function() {
            selectDay(this);
        });
    });
    
    // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–∏
    document.querySelectorAll('.time-slot').forEach(slot => {
        slot.addEventListener('click', function() {
            if (!this.classList.contains('booked')) {
                selectTime(this);
            }
        });
    });
    
    // –§–æ—Ä–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    document.getElementById('bookingForm').addEventListener('submit', function(event) {
        event.preventDefault();
        processBooking();
    });
    
    // –ò–≥—Ä–∞
    document.getElementById('gameLink').addEventListener('click', function(e) {
        e.preventDefault();
        alert('üéÆ –ò–≥—Ä–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –°–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞!');
    });
    
    // ===== –î–û–ë–ê–í–¨–¢–ï –≠–¢–û–¢ –ö–û–î –ó–î–ï–°–¨ =====
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ª—é–¥–µ–π –≤ –≤—ã–ø–∞–¥–∞—é—â–µ–º —Å–ø–∏—Å–∫–µ
    document.getElementById('bookingPeople').addEventListener('change', function() {
        const people = parseInt(this.value);
        console.log('–ò–∑–º–µ–Ω–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–µ–ª–æ–≤–µ–∫:', people);
        
        if (selectedTour && selectedDay && selectedTime && people) {
            const availableSeats = window.db.getAvailableSeats(selectedTour, selectedDay, selectedTime);
            console.log('–î–æ—Å—Ç—É–ø–Ω–æ –º–µ—Å—Ç:', availableSeats, '–í—ã–±—Ä–∞–Ω–æ:', people);
            
            if (people > availableSeats) {
                alert(`‚ùå –í—ã –Ω–µ –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å ${people} —á–µ–ª–æ–≤–µ–∫.\n–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ ${availableSeats} –º–µ—Å—Ç.`);
                this.value = '';
                
                // –í–∏–∑—É–∞–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
                const option = this.options[this.selectedIndex];
                if (option) {
                    option.style.color = '#ff4444';
                    option.style.fontWeight = 'bold';
                }
                
                // –í—ã–∑—ã–≤–∞–µ–º —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π, —á—Ç–æ–±—ã alert –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª
                setTimeout(() => {
                    updatePeopleDropdown();
                }, 100);
            }
        }
    });
    // ===== –ö–û–ù–ï–¶ –î–û–ë–ê–í–õ–ï–ù–ù–û–ì–û –ö–û–î–ê =====
    
    // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫
    showDayTimes('monday');
});
</script>
</body>
</html>