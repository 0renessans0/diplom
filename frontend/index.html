<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ó–∞–≤–æ–¥–ü–∏—â–µ–ü—Ä–æ–º - –ì–ª–∞–≤–Ω–∞—è</title>
    <link rel="stylesheet" href="src/css/style.css">
    <link rel="stylesheet" href="src/css/modal.css">
    <link rel="stylesheet" href="src/css/forms.css">
</head>
<body class="main-bg">
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–æ–∑—Ä–∞—Å—Ç–∞ -->
    <div id="ageModal" class="modal">
        <div class="modal-content">
            <h2>–í–∞–º –µ—Å—Ç—å 18 –ª–µ—Ç?</h2>
            <p>–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∞–π—Ç—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤–æ–∑—Ä–∞—Å—Ç</p>
            <div class="modal-buttons">
                <button id="confirmAge" class="btn btn-primary">–î–∞, –º–Ω–µ –µ—Å—Ç—å 18</button>
                <button id="denyAge" class="btn btn-secondary">–ù–µ—Ç, –º–Ω–µ –º–µ–Ω—å—à–µ 18</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç–∫–∞–∑–∞ -->
    <div id="denyModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω</h2>
            <p>–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –¥–æ—Å—Ç—É–ø –∫ —Å–∞–π—Ç—É —Ä–∞–∑—Ä–µ—à–µ–Ω —Ç–æ–ª—å–∫–æ –ª–∏—Ü–∞–º —Å—Ç–∞—Ä—à–µ 18 –ª–µ—Ç.</p>
            <button id="closeDeny" class="btn btn-secondary">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç–∑—ã–≤–∞ -->
    <div id="reviewModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</h2>
            <form id="reviewForm">
                <div class="form-group">
                    <label for="reviewName">–§–ò–û *</label>
                    <input type="text" id="reviewName" name="name" required>
                </div>
                <div class="form-group">
                    <label for="reviewPhone">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ *</label>
                    <input type="tel" id="reviewPhone" name="phone" required placeholder="8 800 352-67-66">
                </div>
                <div class="form-group">
                    <label for="reviewTour">–≠–∫—Å–∫—É—Ä—Å–∏—è *</label>
                    <select id="reviewTour" name="tour" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —ç–∫—Å–∫—É—Ä—Å–∏—é</option>
                        <option value="beer">–ü–∏–≤–Ω–∞—è —ç–∫—Å–∫—É—Ä—Å–∏—è</option>
                        <option value="kvas">–ö–≤–∞—Å–Ω–∞—è —ç–∫—Å–∫—É—Ä—Å–∏—è</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="reviewText">–û—Ç–∑—ã–≤ *</label>
                    <textarea id="reviewText" name="text" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label>–û—Ü–µ–Ω–∫–∞</label>
                    <div class="rating-stars">
                        <span class="star" data-value="1">‚òÖ</span>
                        <span class="star" data-value="2">‚òÖ</span>
                        <span class="star" data-value="3">‚òÖ</span>
                        <span class="star" data-value="4">‚òÖ</span>
                        <span class="star" data-value="5">‚òÖ</span>
                    </div>
                    <input type="hidden" id="reviewRating" name="rating" value="0">
                </div>
                <button type="submit" class="btn btn-book-confirm">
                    <span class="btn-icon">‚úçÔ∏è</span>
                    <span>–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</span>
                </button>
            </form>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div id="mainContent" style="display: none;">
        <!-- –•–µ–¥–µ—Ä -->
        <header class="header">
            <nav class="nav">
                <div class="nav-links">
                    <a href="index.html" class="nav-link active">
                        <span class="nav-icon">üè†</span>
                        <span>–ì–ª–∞–≤–Ω–∞—è</span>
                    </a>
                    <a href="excursions.html" class="nav-link">
                        <span class="nav-icon">üìÖ</span>
                        <span>–≠–∫—Å–∫—É—Ä—Å–∏–∏</span>
                    </a>
                    <a href="#" class="nav-link" id="gameLink">
                        <span class="nav-icon">üéÆ</span>
                        <span>–ò–≥—Ä–∞</span>
                    </a>
                </div>
            </nav>
        </header>

        <!-- –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main class="main-container">
            <div class="hero-section">
                <h1 class="hero-title">–ó–∞–≤–æ–¥–ü–∏—â–µ–ü—Ä–æ–º</h1>
                <p class="hero-subtitle">–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –Ω–∞–ø–∏—Ç–∫–∏ —Å 1920 –≥–æ–¥–∞</p>
                
                <div class="cta-section">
                    <h2>–•–æ—Ç–∏—Ç–µ —É–≤–∏–¥–µ—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∏–∑–Ω—É—Ç—Ä–∏?</h2>
                    <a href="excursions.html" class="btn-book-main">
                        <span class="btn-icon">üìã</span>
                        <span>–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —ç–∫—Å–∫—É—Ä—Å–∏—é</span>
                    </a>
                </div>
            </div>

            <div class="tours-overview">
                <div class="tour-preview beer-tour">
                    <div class="preview-header">
                        <div class="preview-icon">üç∫</div>
                        <h3>–ü–∏–≤–Ω–∞—è —ç–∫—Å–∫—É—Ä—Å–∏—è</h3>
                    </div>
                    <div class="preview-info">
                        <p><strong>–î–Ω–∏</strong>: –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, –°—Ä–µ–¥–∞, –ü—è—Ç–Ω–∏—Ü–∞</p>
                        <p><strong>–í—Ä–µ–º—è</strong>: 12:00, 14:00, 16:00</p>
                        <p><strong>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</strong>: 2 —á–∞—Å–∞</p>
                        <p><strong>–ì—Ä—É–ø–ø–∞</strong>: –¥–æ 15 —á–µ–ª–æ–≤–µ–∫</p>
                    </div>
                    <a href="excursions.html" class="btn-book-secondary">
                        <span class="btn-icon">üìÖ</span>
                        <span>–í—ã–±—Ä–∞—Ç—å –≤—Ä–µ–º—è</span>
                    </a>
                </div>

                <div class="tour-preview kvas-tour">
                    <div class="preview-header">
                        <div class="preview-icon">ü•§</div>
                        <h3>–ö–≤–∞—Å–Ω–∞—è —ç–∫—Å–∫—É—Ä—Å–∏—è</h3>
                    </div>
                    <div class="preview-info">
                        <p><strong>–î–Ω–∏</strong>: –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, –°—Ä–µ–¥–∞, –ü—è—Ç–Ω–∏—Ü–∞</p>
                        <p><strong>–í—Ä–µ–º—è</strong>: 13:00, 15:00, 17:00</p>
                        <p><strong>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</strong>: 2 —á–∞—Å–∞</p>
                        <p><strong>–ì—Ä—É–ø–ø–∞</strong>: –¥–æ 15 —á–µ–ª–æ–≤–µ–∫</p>
                    </div>
                    <a href="excursions.html" class="btn-book-secondary">
                        <span class="btn-icon">üìÖ</span>
                        <span>–í—ã–±—Ä–∞—Ç—å –≤—Ä–µ–º—è</span>
                    </a>
                </div>
            </div>

            <!-- –ë–ª–æ–∫ –æ—Ç–∑—ã–≤–æ–≤ -->
            <div class="reviews-section">
                <h2 class="reviews-title">–û—Ç–∑—ã–≤—ã –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π</h2>
                <div class="reviews-container" id="reviewsContainer">
                    <div class="review-loading">–ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–∑—ã–≤–æ–≤...</div>
                </div>
                <button id="loadMoreReviews" class="btn-book-secondary" style="margin-top: 2rem; display: none;">
                    <span class="btn-icon">üìù</span>
                    <span>–ü–æ–∫–∞–∑–∞—Ç—å –µ—â—ë –æ—Ç–∑—ã–≤—ã</span>
                </button>
            </div>
        </main>

        <!-- –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å -->
        <footer class="bottom-panel">
            <div class="panel-left">
                <span class="contact-icon">üìû</span>
                <span>8 800 352-67-66</span>
            </div>
            <div class="panel-center">
                <button id="openReview" class="btn-review">
                    <span class="review-icon">‚úçÔ∏è</span>
                    <span>–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</span>
                </button>
            </div>
            <div class="panel-right">
                <span class="contact-icon">‚úâÔ∏è</span>
                <span>pivo@yandex.ru</span>
            </div>
        </footer>
    </div>

    <script src="src/js/age-verification.js"></script>
    <script src="src/js/db-service.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üè† –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
            window.db = new DatabaseService();
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–∑—ã–≤–æ–≤
            let reviewsOffset = 0;
            const reviewsLimit = 4;
            
            function loadReviews() {
                const reviewsContainer = document.getElementById('reviewsContainer');
                if (!reviewsContainer) return;
                
                const reviews = window.db.getReviews(reviewsLimit, reviewsOffset);
                const totalReviews = window.db.getReviewsCount();
                
                if (reviewsOffset === 0) {
                    reviewsContainer.innerHTML = '';
                }
                
                if (reviews.length === 0 && reviewsOffset === 0) {
                    reviewsContainer.innerHTML = '<div class="no-reviews">–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</div>';
                    return;
                }
                
                reviews.forEach(review => {
                    const reviewCard = document.createElement('div');
                    reviewCard.className = 'review-card';
                    
                    // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É
                    const date = new Date(review.date);
                    const formattedDate = date.toLocaleDateString('ru-RU', {
                        day: 'numeric',
                        month: 'long',
                        year: 'numeric'
                    });
                    
                    // –°–æ–∑–¥–∞–µ–º –∑–≤–µ–∑–¥—ã —Ä–µ–π—Ç–∏–Ω–≥–∞
                    let stars = '';
                    for (let i = 1; i <= 5; i++) {
                        stars += i <= review.rating ? '‚òÖ' : '‚òÜ';
                    }
                    
                    reviewCard.innerHTML = `
                        <div class="review-header">
                            <div class="review-author">${review.name}</div>
                            <div class="review-date">${formattedDate}</div>
                        </div>
                        <div class="review-rating">${stars}</div>
                        <div class="review-text">${review.text}</div>
                        <div class="review-tour">–≠–∫—Å–∫—É—Ä—Å–∏—è: ${review.tour === 'beer' ? '–ü–∏–≤–Ω–∞—è' : '–ö–≤–∞—Å–Ω–∞—è'}</div>
                    `;
                    
                    reviewsContainer.appendChild(reviewCard);
                });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É
                const loadMoreBtn = document.getElementById('loadMoreReviews');
                if (loadMoreBtn) {
                    if (reviewsOffset + reviewsLimit >= totalReviews) {
                        loadMoreBtn.style.display = 'none';
                    } else {
                        loadMoreBtn.style.display = 'inline-flex';
                    }
                }
            }
            
            // –ö–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –µ—â—ë"
            const loadMoreBtn = document.getElementById('loadMoreReviews');
            if (loadMoreBtn) {
                loadMoreBtn.addEventListener('click', function() {
                    reviewsOffset += reviewsLimit;
                    loadReviews();
                });
            }
            
            // –ò–∑–Ω–∞—á–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–∑—ã–≤–æ–≤
            loadReviews();
            
            // –ö–Ω–æ–ø–∫–∞ "–ò–≥—Ä–∞"
            const gameLink = document.getElementById('gameLink');
            if (gameLink) {
                gameLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    alert('–ò–≥—Ä–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –°–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞!');
                });
            }

            // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ –æ—Ç–∑—ã–≤–∞
            const openReviewBtn = document.getElementById('openReview');
            const reviewModal = document.getElementById('reviewModal');
            const closeReviewBtn = reviewModal?.querySelector('.close-modal');
            
            if (openReviewBtn && reviewModal) {
                openReviewBtn.addEventListener('click', function() {
                    reviewModal.style.display = 'flex';
                    document.body.style.overflow = 'hidden';
                });
            }
            
            if (closeReviewBtn) {
                closeReviewBtn.addEventListener('click', function() {
                    reviewModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                });
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –º–æ–¥–∞–ª–∫–∏
            window.addEventListener('click', function(event) {
                if (event.target === reviewModal) {
                    reviewModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
            
            // –ó–≤–µ–∑–¥—ã —Ä–µ–π—Ç–∏–Ω–≥–∞
            const stars = document.querySelectorAll('.star');
            const ratingInput = document.getElementById('reviewRating');
            let currentRating = 0;
            
            stars.forEach(star => {
                star.addEventListener('click', function() {
                    currentRating = parseInt(this.dataset.value);
                    ratingInput.value = currentRating;
                    
                    stars.forEach((s, index) => {
                        if (index < currentRating) {
                            s.classList.add('active');
                        } else {
                            s.classList.remove('active');
                        }
                    });
                });
            });
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –æ—Ç–∑—ã–≤–∞
            const reviewForm = document.getElementById('reviewForm');
            if (reviewForm) {
                reviewForm.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    const name = document.getElementById('reviewName').value;
                    const phone = document.getElementById('reviewPhone').value;
                    const tour = document.getElementById('reviewTour').value;
                    const text = document.getElementById('reviewText').value;
                    const rating = currentRating;
                    
                    if (!name || !phone || !tour || !text || rating === 0) {
                        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∏ –ø–æ—Å—Ç–∞–≤—å—Ç–µ –æ—Ü–µ–Ω–∫—É');
                        return;
                    }
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç–∑—ã–≤ –≤ –ë–î
                    const reviewData = {
                        name: name,
                        phone: phone,
                        tour: tour,
                        text: text,
                        rating: rating,
                        date: new Date().toISOString()
                    };
                    
                    const success = window.db.addReview(reviewData);
                    
                    if (success) {
                        alert('‚úÖ –û—Ç–∑—ã–≤ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à–µ –º–Ω–µ–Ω–∏–µ.');
                        
                        // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
                        reviewForm.reset();
                        stars.forEach(star => star.classList.remove('active'));
                        currentRating = 0;
                        ratingInput.value = 0;
                        
                        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏
                        reviewModal.style.display = 'none';
                        document.body.style.overflow = 'auto';
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –æ—Ç–∑—ã–≤–æ–≤
                        reviewsOffset = 0;
                        loadReviews();
                    } else {
                        alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –æ—Ç–∑—ã–≤–∞');
                    }
                });
            }
        });
    </script>
</body>
</html>